<ion-header>
  <ion-toolbar color="primary">
    <ion-grid>
      <ion-row>
        <ion-col class="ion-text-center">
          <ion-button fill="clear" color="light" [routerLink]="['/home']">
            Inicio
          </ion-button>
        </ion-col>

        <ion-col class="ion-text-center">
          <ion-button fill="clear" color="light" [routerLink]="['/community']">
            Comunidad
          </ion-button>
        </ion-col>

        <ion-col class="ion-text-center">
          <!-- Muestra "Perfil" o "Iniciar Sesión" -->
          <ion-button fill="clear" color="light" (click)="onProfileButtonClick($event)">
            {{ isLoggedIn ? 'Perfil' : 'Iniciar Sesión' }}
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-header>

<!-- Overlay desenfoque -->
<div class="backdrop-blur" *ngIf="showPopover" (click)="showPopover=false"></div>


<!-- Menú desplegable -->
<ion-popover [isOpen]="showPopover" (didDismiss)="showPopover = false" [event]="popoverEvent">
  <ng-template>
    <ion-content>
      <ion-list>
        <ion-item button (click)="goToProfileFromMenu()">
          <ion-label>Ir al Perfil</ion-label>
        </ion-item>
        <ion-item button (click)="logout()">
          <ion-label>Cerrar Sesión</ion-label>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-popover>


<ion-content color="tertiary">
  <div class="results-container">
    <ion-title class="results-title" color="primary">Resultados de búsqueda</ion-title>

    <ng-container *ngIf="results && (results.institutions.length || results.teachers.length); else noResults">

      <!-- Instituciones -->
      <ion-card
        button="true"
        (click)="openResult(item)"
        *ngFor="let item of results.institutions"
        class="clickable-card"
      >
        <ion-card-header>
          <ion-card-subtitle color="medium">Institución</ion-card-subtitle>
          <ion-card-title class="name">{{ item.eduname }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>{{ item.address }}</p>
        </ion-card-content>
      </ion-card>

      <!-- Profesores -->
      <ion-card
        *ngFor="let item of results.teachers" 
        button="true"
        [routerLink]="['/teacher-page', item.teacherpageid]"
        class="clickable-card"
        routerDirection="forward"
        detail="false"
      >
        <ion-card-header>
          <ion-card-subtitle>Profesor</ion-card-subtitle>
          <ion-card-title class="name">{{ item.name }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p class = "contenido-card">{{ item.content }}</p>
        </ion-card-content>
      </ion-card>

    </ng-container>

    <ng-template #noResults>
      <ion-text color="medium" class="no-results-text">No se encontraron resultados.</ion-text>
    </ng-template>
  </div>
</ion-content>
